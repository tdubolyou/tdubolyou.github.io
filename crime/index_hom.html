<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Mapbox ArcGIS Integration</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.css' rel='stylesheet' />
    <style>
        body { margin: 0; padding: 0; }
        #map { position: absolute; top: 0; bottom: 0; width: 100%; }
    </style>
</head>
<body>
<div id='map'></div>

<script>
mapboxgl.accessToken = 'pk.eyJ1IjoidHdlYXRoZXJidXJuIiwiYSI6IllqeWNoS28ifQ.LX7mJDglVdZODqd25Z8aeg';

var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/streets-v11',
    center: [-79.347015, 43.651070], // Example center: Toronto
    zoom: 9
});

map.on('load', function () {
    // URL of the ArcGIS REST API endpoint
    var arcgisDataUrl = 'https://services.arcgis.com/S9th0jAJ7bqgIRjw/arcgis/rest/services/Homicides_Open_Data_ASR_RC_TBL_002/FeatureServer/0/query?outFields=*&where=1%3D1&f=geojson';

    // Fetch the data from the ArcGIS REST API
    fetch(arcgisDataUrl)
        .then(response => response.json())
        .then(data => {
            // Once the data is loaded, add it as a source to the map
            map.addSource('homicides', {
                type: 'geojson',
                data: data
            });

            // Add a layer to display the data as points
            map.addLayer({
                id: 'homicides-layer',
                type: 'circle',
                source: 'homicides',
                paint: {
                    'circle-radius': 5,
                    'circle-color': '#ff0000'
                }
            });
        })
        .catch(error => console.error('Error loading the data: ', error));
});
</script>

</body>
</html>
